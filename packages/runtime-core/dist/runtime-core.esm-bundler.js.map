{"version":3,"file":"runtime-core.esm-bundler.js","sources":["../../shared/src/index.ts","../../reactivity/src/effect.ts","../../reactivity/src/baseHandlers.ts","../../reactivity/src/reactive.ts","../../reactivity/src/computed.ts","../src/vnode.ts","../src/apiCreateApp.ts","../src/componentPublicInstance.ts","../src/component.ts","../src/scheduler.ts","../src/renderer.ts","../src/h.ts"],"sourcesContent":["\nexport const isObject = (value) => typeof value == 'object' && value !== null;\nexport const extend = Object.assign\nexport const isArray = Array.isArray\nexport const isFunction = (value) => typeof value == 'function'\nexport const isNumber = (value) => typeof value == 'number'\nexport const isString = (value) => typeof value == 'string'\nexport const isIntegerKey = (key) => parseInt(key) + '' === key\nlet hasOwnpRroperty = Object.prototype.hasOwnProperty;\nexport const hasOwn = (target,key) => hasOwnpRroperty.call(target, key)\nexport const hasChanged = (oldValue, value) => oldValue != value\nexport * from './shapeFlags'\n// export const\n// export const\n","import { isArray, isIntegerKey } from \"@vue/shared\"\nimport { TriggerOrTyps } from \"./operators\"\n\n// 通过track去收集所有依赖\n// trigger 去触发effect\nexport function effect(fn,options:any = {}) {\n\tconst effect = createReactiveEffect(fn,options)\n\tif(!options.lazy){\n\t\tconsole.log('默认执行')\n\t\teffect()// effect默认会先执行一次\n\t}\n\n\treturn effect\n}\n\nlet uid = 0\nlet activeEffect //用于存储当前effect\nconst effectStack = []\nfunction createReactiveEffect(fn,options){\n\tconst effect = function reactiveEffect() {\n\t\t// console.log('todo...')\n\t\tif(!effectStack.includes(effect)){\n\t\t\ttry {\n\t\t\t\teffectStack.push(effect)\n\t\t\t\tactiveEffect = effect\n\t\t\t\treturn fn()// 函数执行 会执行get方法\n\t\t\t} finally {\n\t\t\t\teffectStack.pop()\n\t\t\t\tactiveEffect = effectStack[effectStack.length - 1]\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\teffect.id = uid++ //加id用于区分effect\n\teffect._isEffect = true // 标识这是一个响应式的effect\n\teffect.raw = fn // 保存effect对应的原函数\n\teffect.options = options // 在effect上保存用户的属性\n\treturn effect\n}\n// 对象属性收集他对应的effect函数 相当于2中的watcher\nconst targetMap = new WeakMap();\nexport function track(target, type, key){\n\t// activeEffect\n\tif(activeEffect === undefined) {\n\t\treturn;\n\t}\n\tlet depsMap = targetMap.get(target)\n\tif(!depsMap){\n\t\ttargetMap.set(target,(depsMap = new Map))\n\t}\n\tlet dep = depsMap.get(key)\n\tif(!dep){\n\t\tdepsMap.set(key,(dep = new Set))\n\t}\n\tif(!dep.has(activeEffect)){\n\t\tdep.add(activeEffect)\n\t\t// activeEffect.deps.push(dep)// 双向记录方便取值\n\t}\n\t// 这个dep的key就是object的属性如state.name中的name，value就是effect(fn) 中的fn，即是副作用activeEffect\n\tconsole.log(targetMap, key, target)\n\t// console.log(target,key,activeEffect)\n}\n\n// 属性对应的effect（数组，对象）\nexport function trigger(target, type, key?, newValue?, oldValue?) {\n\tconst depsMap = targetMap.get(target)\n\tif(!depsMap) return;\n\n\tconst effects = new Set() //对effect去重\n\t// 将所有要执行的effect存到一个新的set中最后一起执行\n\tconst add = (effectsToAdd) => {\n\t\tif(effectsToAdd){\n\t\t\teffectsToAdd.forEach(effect => effects.add(effect));\n\t\t\t// effectsToAdd.forEach(effect => effects());\n\t\t}\n\t}\n\n\t// 1.修改的是数组长度\n\tif(key === 'length' && isArray(target)){\n\t\t// 如果对应的长度，有新加入需要收集依赖\n\t\tdepsMap.forEach((dep, key) => {\n\t\t\tif(key === 'length' || key > newValue) { // 如果更改的长度小于收集的索引那这个索引也要触发effect跟新执行\n\t\t\t\tadd(dep)\n\t\t\t}\n\t\t})\n\t}else{\n\t\t//对象\n\t\tif(key !== undefined){ //这里肯定是修改\n\t\t\tadd(depsMap.get(key))\n\t\t}\n\t\t// 修改了数组中的某个索引\n\t\tswitch (type) {\n\t\t\tcase TriggerOrTyps.ADD: //添加一个索引就触发长度更新\n\t\t\t\tif(isArray(target) && isIntegerKey(key)){\n\t\t\t\t\tadd(depsMap.get('length'))\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\teffects.forEach((effect:any) => {\n\t\tif(effect.options.scheduler){\n\t\t\t// console.log('scheduler-----')\n\t\t\teffect.options.scheduler(effect)\n\t\t}else{\n\t\t\teffect()\n\t\t}\n\t})\n}","import { extend, hasChanged, hasOwn, isArray, isIntegerKey, isObject } from '@vue/shared/src'\nimport { readonly, reactive } from './reactive'\nimport { track, trigger } from './effect'\nimport { TrackOpTyps, TriggerOrTyps } from './operators'\n\nfunction createGetter(isReadonly = false, shallow = false) {// 拦截获取功能\n\treturn function get(target, key, receiver){\n\t\t// proxy + reflect\n\t\t// 后续Object上的方法 会迁移到Reflect ,之前的target[key] = value 方式设置值可能会失败，并不会报异常，也没有返回值标识\n\t\tconst res = Reflect.get(target, key, receiver)\n\n\t\tif(!isReadonly){\n\t\t\t// 依赖收集，数据变化时更新视图\n\t\t\tconsole.log('执行effect时会取值','收集effect')\n\t\t\ttrack(target, TrackOpTyps.GET, key)\n\t\t}\n\n\t\tif(shallow){\n\t\t\treturn res\n\t\t}\n\n\t\tif(isObject(res)){ //vue2 是一上来就递归，vue3是取值时才进行\n\t\t\treturn isReadonly ? readonly(res) : reactive(res)\n\t\t}\n\n\t\treturn res\n\t}\n}\n\nfunction createSetter(shallow = false) { // 拦截设置功能\n\treturn function get(target, key, value, receiver){\n\t\tconst oldValue = target[key];\n\t\tlet hadkey = isArray(target) && isIntegerKey(key) ? Number(key) < target.length : hasOwn(target, key)\n\t\tconst res = Reflect.set(target, key, value, receiver)\n\t\t// 数据更新时 通知对应属性的effect执行\n\t\tif(!hadkey){\n\t\t\t//增加\n\t\t\ttrigger(target, TriggerOrTyps.ADD, key, value)\n\t\t}else if(hasChanged(oldValue, value)){\n\t\t\t//修改\n\t\t\ttrigger(target, TriggerOrTyps.SET, key, value, oldValue)\n\t\t}\n\n\t\treturn res\n\t}\n}\n\nconst get = createGetter()\nconst shallowGet = createGetter(false, true)\nconst readonlyGet = createGetter(true)\nconst shallowReadonlyGet = createGetter(true, true)\n\nconst set = createSetter()\nconst shallowSet = createSetter(true)\n\nexport const mutableHandlers = {\n\tget,\n\tset\n}\n\nexport const shallowReactiveHandlers = {\n\tget:shallowGet,\n\tset:shallowSet\n}\n\nlet readonlyObj = {\n\tset:(target,key)=>{\n\t\tconsole.warn(`set on '${target}' key '${key}' falied`)\n\t}\n}\n\nexport const shallowReadonlyHandlers = extend({\n\tget:shallowReadonlyGet,\n},readonlyObj)\n\nexport const readonlyHandlers = extend({\n\tget:readonlyGet\n},readonlyObj)\n\n","import { isObject } from '@vue/shared/src'\n\nimport {\n\tmutableHandlers,\n\tshallowReactiveHandlers,\n\tshallowReadonlyHandlers,\n\treadonlyHandlers,\n} from './baseHandlers'\nexport function reactive(target){\n\treturn createReactiveObject(target, false, mutableHandlers)\n\n} \n\nexport function shallowReactive(target){\n\treturn createReactiveObject(target, false, shallowReactiveHandlers)\n\n}\nexport function shallowReadonly(target){\n\treturn createReactiveObject(target, true, shallowReadonlyHandlers)\n\n}\nexport function readonly(target){\n\treturn createReactiveObject(target, true, readonlyHandlers)\n\n}\nconst reactiveMap = new WeakMap() //存储的key只能是对象，会自动垃圾回收，不会造成内存泄漏\nconst readonlyMap = new WeakMap()\nexport function createReactiveObject(target, isReadonly, baseHandlers){\n\t// 如果target不是对象，不拦截，reactive这个api只能拦截对象类型\n\tif(!isObject(target)){\n\t\treturn target\n\t}\n\tconst proxyMap = isReadonly ? readonlyMap : reactiveMap\n\tconst existProxy = proxyMap.get(target)\n\tif(existProxy){\n\t\treturn existProxy\n\t}\n\tconst proxy = new Proxy(target, baseHandlers)\n\tproxyMap.set(target,proxy)\n\treturn proxy;\n}","import { isFunction } from './../../shared/src/index';\nimport { effect, track, trigger } from './effect';\nimport { TrackOpTyps, TriggerOrTyps } from './operators';\n\nclass ComputedRefImpl{\n\tpublic _dirty = true;\n\tpublic _value;\n\tpublic effect\n\tconstructor(public getter, public setter){\n\t\t// 计算属性会默认产生一个effect\n\t\tthis.effect = effect(getter,{\n\t\t\tlazy: true,\n\t\t\tscheduler:()=>{\n\t\t\t\tif(!this._dirty){\n\t\t\t\t\tthis._dirty = true\n\t\t\t\t\ttrigger(this, TriggerOrTyps.SET,'value')\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tget value(){\n\t\tif(this._dirty){\n\t\t\tthis._value = this.effect() // 返回用户返回值\n\t\t\tthis._dirty = false\n\t\t}\n\t\t// 计算属性页要依赖收集\n\t\ttrack(this, TrackOpTyps.GET, 'value')\n\t\treturn this._value;\n\t}\n\t\n\tset value(newValue){\n\t\tthis.setter(newValue)\n\t}\n}\n\nexport function computed(getterOrOptions) {\n\tlet getter\n\tlet setter\n\n\tif(isFunction(getterOrOptions)){\n\t\tgetter = getterOrOptions\n\t\tsetter = () => {\n\t\t\tconsole.warn('computed value must be readonly')\n\t\t}\n\t}else{\n\t\tgetter = getterOrOptions.get\n\t\tsetter = getterOrOptions.set\n\t}\n\n\treturn new ComputedRefImpl(getter, setter)\n}","import { isArray, isObject, isString, ShapeFlags } from \"@vue/shared\"\n\nexport function isVnode(vnode){\n\treturn vnode.__v_isVnode\n}\n\nexport const createVNode = (type, props, children = null) => {\n\t// type区分组件还是普通元素\n\n\tconst shapeFlag = isString(type) ? \n\tShapeFlags.ELEMENT : isObject(type) ? \n\tShapeFlags.STATEFUL_COMPONENT : 0\n\n\tconst vnode = {\n\t\t__v_isVnode: true,\n\t\ttype,\n\t\tprops,\n\t\tchildren,\n\t\tcomponent: null, // 组件对应的实例\n\t\tel: null, // 真实节点，和虚拟节点对应\n\t\tkey: props && props.key,// diff中使用\n\t\tshapeFlag // 判断出自己的类型和儿子的类型\n\t}\n\tnormalizeChildren(vnode, children)\n\treturn vnode\n}\n\nfunction normalizeChildren(vnode, children){\n\tlet type = 0\n\tif(children == null){\n\t\t\n\t}else if(isArray(children)){\n\t\ttype = ShapeFlags.ARRAY_CHILDREN\n\t}else{\n\t\ttype = ShapeFlags.TEXT_CHILDREN\n\t}\n\n\tvnode.shapeFlag |= type\n}\n\nexport const Text = Symbol(\"Text\")\n\nexport function normalizeVNode(child){\n\tif(isObject(child)) return child\n\n\treturn createVNode(Text,null,String(child))\n}","import { createVNode } from \"./vnode\"\n\nexport function createAppAPI(render){\n\treturn function createApp(rootComponent,rootProps){\n\t\tconst app = {\n\t\t\t_component:rootComponent,\n\t\t\t_props:rootProps,\n\t\t\t_container:null,\n\t\t\tmount(container){\n\t\t\t\t// console.log(container,rootComponent,rootProps,rendererOptions)\n\t\t\t\tconst vnode = createVNode(rootComponent,rootProps)\n\n\t\t\t\trender(vnode, container)\n\n\t\t\t\tapp._container = container\n\t\t\t}\n\t\t}\n\t\treturn app\n\t}\n}","import { hasOwn } from \"@vue/shared\";\n\nexport const PublicInstanceProxyHandlers = {\n\tget({_: instance}, key) {\n\t\tconst { setupState, props, data } = instance;\n\t\tif(key[0] == '$') {\n\t\t\treturn //不能访问$开头的变量\n\t\t}\n\n\t\tif(hasOwn(setupState, key)){\n\t\t\treturn setupState[key];\n\t\t}else if(hasOwn(props, key)){\n\t\t\treturn props[key];\n\t\t}else if(hasOwn(data, key)){\n\t\t\treturn data[key];\n\t\t}\n\t},\n\n\tset({_: instance}, key, value) {\n\t\tconst { setupState, props, data } = instance;\n\n\t\tif(hasOwn(setupState, key)){\n\t\t\tsetupState[key] = value\n\t\t}else if(hasOwn(props, key)){\n\t\t\tprops[key] = value\n\t\t}else if(hasOwn(data, key)){\n\t\t\tdata[key] = value\n\t\t}\n\t\treturn true\n\t}\n}","import { isFunction, isObject, ShapeFlags } from \"@vue/shared\"\nimport { PublicInstanceProxyHandlers } from \"./componentPublicInstance\"\n// 创建实例\nexport function createComponentInstance(vnode){\n\t// webComponent 需要有‘属性’ ‘插槽’\n\tconst instance = {\n\t\tvnode,\n\t\ttype: vnode.type, //用户写的对象\n\t\tprops:{},// props{c:3}\n\t\tattrs:{},// <my-component a=1 b=2>\n\t\tslots:{},\n\t\tctx:{},\n\t\tdata:{},\n\t\tsetupState:{},// 如果setup返回一个对象，这个对象会作为setuoUpstate\n\t\trender: null,\n\t\tisMounted: false,//是否挂载过\n\t}\n\tinstance.ctx = {_: instance} // 代理\n\treturn instance\n}\n\nexport function setupComponent(instance){\n\tconst { props, children} = instance.vnode\n\tinstance.props = props //initProps() 根据props 解析出props 和 attrs \n\tinstance.children = children // initSlot()\n\n\tlet isStateful = instance.vnode.shapeFlag & ShapeFlags.STATEFUL_COMPONENT\n\t//是否是有状态的组件，函数组件无state\n\tif(isStateful){\n\t\t// 调用当前实例的setup得到返回值，填充setupState和对应的render方法\n\t\tsetupStatefulComponent(instance)\n\t}\n\n}\n\nfunction setupStatefulComponent(instance){\n\t// 代理，给render函数传递参数\n\tinstance.proxy = new Proxy(instance.ctx, PublicInstanceProxyHandlers)\n\t// 获取组件类型，拿到组件的setup方法\n\tlet Component = instance.type\n\tlet { setup } = Component\n\tif(setup){\n\t\tlet setupContext = createSetupContext(instance)\n\t\tconst setupResult =  setup(instance.props, setupContext);// 拿到instance中的props attrs slots emit expose\n\t\t// 可能是一个函数也可能是一个对象setupResult\n\t\thandleSetupResult(instance, setupResult)\n\t}else{\n\t\tfinishComponentSetup(instance)\n\t}\n}\n\nfunction handleSetupResult(instance, setupResult){\n\tif(isFunction(setupResult)){\n\t\tinstance.render = setupResult\n\t}else if(isObject(setupResult)){\n\t\tinstance.setupState = setupResult\n\t}\n\n\tfinishComponentSetup(instance)\n}\n\nfunction finishComponentSetup(instance){\n\tlet Component = instance.type\n\n\tif(!instance.render){\n\t\t//template -> render函数\n\t\t// render函数放到实例上\n\t\tif(!Component.render && Component.template){\n\t\t}\n\t\tinstance.render = Component.render\n\t\t// applyOptions 对vueSAPI做了兼容\n\t}\n\tconsole.log('render---===', instance.render.toString())\n}\n\nfunction createSetupContext(instance){\n\treturn {\n\t\tattrs: instance.attrs,\n\t\tslots: instance.slots,\n\t\temit: () => {},\n\t\texpose: () => {}\n\t}\n}\n\n// instance 组件各种状态和信息\n// context 4个参数方便开发时使用\n// proxy 代理方面取值vue2中也有","\nlet queue = []\nexport function queueJob(job){\n\tif(!queue.includes(job)){\n\t\tqueue.push(job)\n\t\tqueueFlush()\n\t}\n}\n\nlet isFlushPending = false\nfunction queueFlush() {\n\tif(!isFlushPending){\n\t\tisFlushPending = true\n\t\tPromise.resolve().then(flushJobs)\n\t}\n}\n\nfunction flushJobs(){\n\tisFlushPending = false\n\t// 清空时 需要根据调用的顺序依次刷新 先父再子\n\tqueue.sort((a,b) => a.id - b.id)\n\tfor (let i = 0; i < queue.length; i++) {\n\t\tconst job = queue[i];\n\t\tjob()\n\t}\n\tqueue.length = 0\n}","import { effect } from '@vue/reactivity';\nimport { ShapeFlags } from '@vue/shared';\nimport { createAppAPI } from \"./apiCreateApp\";\nimport { createComponentInstance, setupComponent } from './component';\nimport { queueJob } from './scheduler';\nimport { normalizeVNode, Text } from './vnode';\n// 创建一个渲染器\nexport function createRenderer(rendererOptions){\n\n\tconst {\n\t\tinsert: hostInsert,\n\t\tremove: hostRemove,\n\t\tpatchProp: hostPatchProp,\n\t\tcreateElement: hostCreateElement,\n\t\tcreateText: hostCreateText,\n\t\tcreateComment: hostCreateComment,\n\t\tsetText: hostSetText,\n\t\tsetElementText: hostSetElementText,\n\t\tnextSibling: hostNextSibling,\n\t} = rendererOptions;\n\n\t//-------------------- 组件 ---------------------\n\tconst setupRenderEffect = (instance, container) =>{\n\t\t// 创建一个effect 在effect中调用render 这样render方法中拿到的数据会收集这个effect，属性更新触发effect\n\t\t// instance.render()\n\t\teffect(function componentEffect() {\n\t\t\tif(!instance.isMounted){\n\t\t\t\t// 首次渲染\n\t\t\t\tlet proxyToUse = instance.proxy\n\t\t\t\t// vue2 $vnode _vnode\n\t\t\t\t// vue3 vnode subTree\n\t\t\t\tlet subTree = instance.render.call(proxyToUse, proxyToUse)\n\t\t\t\tpatch(null, subTree, container)\n\t\t\t\tinstance.isMounted = true\n\t\t\t}else{\n\t\t\t\t// update diff 序列优化 watchApi 生命周期\n\t\t\t\tconst prevTree = instance.subTree\n\t\t\t\tlet proxyToUse = instance.proxy\n\t\t\t\tconst nextTree = instance.render.call(proxyToUse,proxyToUse)\n\t\t\t\tconsole.log('更新了diff---===', prevTree, nextTree)\n\n\t\t\t\tpatch(prevTree, nextTree, container)\n\t\t\t}\n\t\t},{\n\t\t\tscheduler:queueJob\n\t\t})\n\t}\n\tconst mountComponent = (initialVNode, container) => {\n\t\t// 调用setup得到返回值，获取render函数返回的结果来进行渲染\n\t\t// 1. 创建实例\n\t\tconst instance = (initialVNode.component = createComponentInstance(initialVNode))\n\t\t// 2. 需要的数据解析到实例上\n\t\tsetupComponent(instance)\n\t\t// 3. 创建effect 让render函数执行\n\t\tsetupRenderEffect(instance, container)\n\t}\n\n\tconst processComponent = (n1, n2, container) => {\n\t\tif(n1 == null){//没有上一次（老）的vnode\n\t\t\tmountComponent(n2, container);\n\t\t}else{\n\t\t\t//跟新，update\n\t\t}\n\t}\n\n\t//-------------------- 组件 ---------------------\n\n\t//-------------------- 元素 ---------------------\n\tconst mountChildren = (children, container) => {\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tlet child = normalizeVNode(children[i])\n\t\t\tpatch(null, child, container)\n\t\t}\n\t}\n\tconst mountElement = (vnode, container, anchor = null) => {\n\t\t// 递归渲染\n\t\tconst { props, shapeFlag, type, children } = vnode\n\t\tlet el = (vnode.el = hostCreateElement(type))\n\n\t\tif(props){\n\t\t\tfor (const key in props) {\n\t\t\t\t//porps渲染\n\t\t\t\t// console.log(props[key],key)\n\t\t\t\thostPatchProp(el,key,null,props[key])\n\t\t\t}\n\t\t}\n\t\tif(shapeFlag & ShapeFlags.TEXT_CHILDREN){\n\t\t\thostSetElementText(el,children)\n\t\t}else if(shapeFlag & ShapeFlags.ARRAY_CHILDREN){\n\t\t\tmountChildren(children, el)\n\t\t}\n\t\t//插入\n\t\thostInsert(el, container, anchor)\n\t}\n\t\n\tconst patchProps = (oldProps, newProps, el) => {\n\t\tif(oldProps !== newProps){\n\t\t\tfor (const key in newProps) {\n\t\t\t\tconst prev = oldProps[key]\n\t\t\t\tconst next = newProps[key]\n\t\t\t\tif(prev !== next){\n\t\t\t\t\thostPatchProp(el, key, prev, next)\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const key in oldProps) {\n\t\t\t\tif(!(key in newProps)){\n\t\t\t\t\thostPatchProp(el, key, oldProps[key], null)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\n\tconst unmountChildren = (children) => {\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tunmount(children[i])\n\t\t}\n\t}\n\n\tconst patchKeydChildren = (c1, c2, el) => {\n\t\t// 内部有优化策略 \n\t\t// abc    i = 0\n\t\t// abde  从头比\n\t\tlet i = 0;\n\t\tlet e1 = c1.length - 1; // 老儿子中最后一项的索引\n\t\tlet e2 = c2.length - 1; // 新儿子中最后一项的索引\n\t\twhile (i <= e1 && i <= e2) {\n\t\t\t\tconst n1 = c1[i];\n\t\t\t\tconst n2 = c2[i];\n\t\t\t\tif (isSameVNodeType(n1, n2)) {\n\t\t\t\t\t\tpatch(n1, n2, el); // 会递归比对子元素\n\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t}\n\t\t// abc // e1 = 2\n\t\t//eabc // e2 = 3 // 从后比\n\t\twhile (i <= e1 && i <= e2) {\n\t\t\t\tconst n1 = c1[e1];\n\t\t\t\tconst n2 = c2[e2];\n\t\t\t\tif (isSameVNodeType(n1, n2)) {\n\t\t\t\t\t\tpatch(n1, n2, el);\n\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\te1--;\n\t\t\t\te2--;\n\t\t}\n\n\t\t//  只考虑 元素新增和删除的情况 \n\t\t// abc => abcd  (i=3  e1=2  e2=3 )    abc  => dabc (i=0  e1=-1  e2=0 )\n\n\t\t// 只要i 大于了 e1 表示新增属性 老的少 新的多  有一方已经完全对比完成了\n\t\tif (i > e1) { // 说明有新增 \n\t\t\t\tif (i <= e2) { // 表示有新增的部分\n\t\t\t\t\t\t// 先根据e2 取他的下一个元素  和 数组长度进行比较\n\t\t\t\t\t\tconst nextPos = e2 + 1;\n\t\t\t\t\t\t// 向前还是向后插入\n\t\t\t\t\t\tconst anchor = nextPos < c2.length ? c2[nextPos].el : null;\n\t\t\t\t\t\twhile (i <= e2) {\n\t\t\t\t\t\t\t\tpatch(null, c2[i], el, anchor); // 向后追加\n\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// abcd  abc (i=3  e1=3  e2=2)\n\t\t} else if (i > e2) { // 删除 老的多 新的少 有一方已经完全对比完成了\n\t\t\t\twhile (i <= e1) {\n\t\t\t\t\t\thostRemove(c1[i].el);\n\t\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t} else {\n\t\t\t\t// 无规律的情况 diff 算法\n\t\t\t\t// ab [cde] fg   // s1=2  e1=4  \n\t\t\t\t// ab [dech] fg  //  s2=2  e2=5;  => [5,4,3,0]; 无视他\n\t\t\t\tconst s1 = i;\n\t\t\t\tconst s2 = i;\n\t\t\t\t// 新的索引 和 key 做成一个映射表\n\t\t\t\t// vue3 用的是新的做映射表 vue用的是老的做映射表\n\t\t\t\tconst keyToNewIndexMap = new Map();\n\t\t\t\tfor (let i = s2; i <= e2; i++) {\n\t\t\t\t\t\tconst nextChild = c2[i];\n\t\t\t\t\t\tkeyToNewIndexMap.set(nextChild.key, i);\n\t\t\t\t}\n\t\t\t\tconst toBePatched = e2 - s2 + 1;\n\t\t\t\tconst newIndexToOldMapIndex = new Array(toBePatched).fill(0);\n\n\t\t\t\t// 只是做相同属性的diff 但是位置可能还不对\n\t\t\t\tfor (let i = s1; i <= e1; i++) {\n\t\t\t\t\t\tconst prevChild = c1[i];\n\t\t\t\t\t\tlet newIndex = keyToNewIndexMap.get(prevChild.key); // 获取新的索引\n\t\t\t\t\t\tif (newIndex == undefined) {\n\t\t\t\t\t\t\t\thostRemove(prevChild.el); // 老的有 新的没有直接删除\n\t\t\t\t\t\t} else {// 新老对比，比较完毕位置后有差异\n\t\t\t\t\t\t\t\t// 新的和旧的索引关系\n\t\t\t\t\t\t\t\tnewIndexToOldMapIndex[newIndex - s2] = i + 1;\n\t\t\t\t\t\t\t\tpatch(prevChild, c2[newIndex], el); // patch操作 会复用元素 更新属性 比较儿子\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//  最长增长序列 [0,1]  [0,1,2,3]\n\t\t\t\tlet increasingIndexSequence = getSequence(newIndexToOldMapIndex)\n\n\t\t\t\tlet j = increasingIndexSequence.length - 1;\n\n\t\t\t\t// 从后面开始插入往前插入，找他的下一个\n\t\t\t\tfor (let i = toBePatched - 1; i >= 0; i--) {\n\t\t\t\t\t\tconst nextIndex = s2 + i; // [edch]   找到h的索引 \n\t\t\t\t\t\tconst nextChild = c2[nextIndex]; // 找到 h\n\t\t\t\t\t\tlet anchor = nextIndex + 1 < c2.length ? c2[nextIndex + 1].el : null; // 找到当前元素的下一个元素，\n\t\t\t\t\t\tif (newIndexToOldMapIndex[i] == 0) { // 这是一个新元素 直接创建插入到 当前元素的下一个即可\n\t\t\t\t\t\t\t\tpatch(null, nextChild, el, anchor)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// 根据参照物 将节点直接移动过去  所有节点都要移动 （但是有些节点可以不动）\n\t\t\t\t\t\t\t\tif(j < 0 || i != increasingIndexSequence[j]){\n\t\t\t\t\t\t\t\t// 此时没有考虑不动的情况 \n\t\t\t\t\t\t\t\t\t\thostInsert(nextChild.el, el, anchor);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tj--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t}\n\n\n\t// 贪心 二分查找\n\tfunction getSequence(arr) { // 最终的结果是索引\n\t\t\tconst p = arr.slice()// 里面内容无所谓，与原来数组相同 用来存放索引\n\t\t\tconst result = [0] // 索引\n\t\t\tlet i, \n\t\t\tj, \n\t\t\tu, // start\n\t\t\tv, // end\n\t\t\tc  //middle\n\t\t\tconst len = arr.length\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\t\tconst arrI = arr[i]\n\t\t\t\t\tif (arrI !== 0) {\n\t\t\t\t\t\t\tj = result[result.length - 1]\n\t\t\t\t\t\t\tif (arr[j] < arrI) {\n\t\t\t\t\t\t\t\t\tp[i] = j // 标记当前前一个对应的索引\n\t\t\t\t\t\t\t\t\tresult.push(i)// 当前啊的值 比上一个大 直接push 并且让这个人得记录他的前一个\n\t\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// 二分查找 找到比当前值大的那一个\n\t\t\t\t\t\t\tu = 0\n\t\t\t\t\t\t\tv = result.length - 1\n\t\t\t\t\t\t\twhile (u < v) { // 重合就说明找到了 对应的值\n\t\t\t\t\t\t\t\t\tc = ((u + v) / 2) | 0 // 找到中间位置的前一个\n\t\t\t\t\t\t\t\t\tif (arr[result[c]] < arrI) {\n\t\t\t\t\t\t\t\t\t\t\tu = c + 1\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tv = c\n\t\t\t\t\t\t\t\t\t}// 找到结果集中，比当前这一项大的数\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// start / end 就是找到的位置\n\t\t\t\t\t\t\tif (arrI < arr[result[u]]) {\n\t\t\t\t\t\t\t\t\tif (u > 0) {//需要替换\n\t\t\t\t\t\t\t\t\t\t\tp[i] = result[u - 1] //将他替换的前一个记住\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tresult[u] = i\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t}\n\t\t\tu = result.length\n\t\t\tv = result[u - 1]\n\t\t\twhile (u-- > 0) {\n\t\t\t\t\tresult[u] = v\n\t\t\t\t\tv = p[v]\n\t\t\t}\n\t\t\treturn result\n\t} // O(nlogn) 性能比 O(n^2)好\n\n\tconst patchChildren = (n1, n2, el) => {\n\t\tconst c1 = n1.children\n\t\tconst c2 = n2.children\n\n\t\tconst prevShapeFlag = n1.shapeFlag\n\t\tconst shapeFlag = n2.shapeFlag//分别标识过儿子的状况\n\t\t// 老的是n个孩子，新的是文件\n\t\tif(shapeFlag === ShapeFlags.TEXT_CHILDREN){ // case 1 现在是文本 之前是数组\n\t\t\tif(prevShapeFlag === ShapeFlags.ARRAY_CHILDREN){\n\t\t\t\tunmountChildren(c1)\n\t\t\t}\n\t\t\t// 两个都是文本\n\t\t\tif(c2 !== c1){ // case 2 之前都是文本\n\t\t\t\thostSetElementText(el, c2)\n\t\t\t}\n\t\t}else{\n\t\t\t// 现在是数组 上次可能是文本或数组\n\t\t\tif(prevShapeFlag & ShapeFlags.ARRAY_CHILDREN){ // case 3 之前和现在都是数组\n\t\t\t\tif(shapeFlag & ShapeFlags.ARRAY_CHILDREN){\n\t\t\t\t\t//当前是数组 之前是数组 2个数组对比 -》 diff算法\n\t\t\t\t\tconsole.log('patch----====diff')\n\t\t\t\t\tpatchKeydChildren(c1, c2, el)\n\t\t\t\t}else{\n\t\t\t\t\t// 没有孩子 特殊情况 当前是null 老的删掉\n\t\t\t\t\tunmountChildren(c1)\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t// case 4 现在是数组之前是文本 \n\t\t\t\tif(prevShapeFlag & ShapeFlags.TEXT_CHILDREN){\n\t\t\t\t\thostSetElementText(el,'')\n\t\t\t\t}\n\t\t\t\tif(shapeFlag & ShapeFlags.ARRAY_CHILDREN){\n\t\t\t\t\tmountChildren(c2,el)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst patchElement = (n1, n2, container) => {\n\t\t//元素是相同节点\n\t\tlet el = (n2.el = n1.el)\n\t\t//跟新属性、跟新儿子\n\t\tconst oldProps = n1.props || {}\n\t\tconst newProps = n2.props || {}\n\n\t\tpatchProps(oldProps, newProps, container)\n\n\t\tpatchChildren(n1, n2, container)\n\t};\n\n\tconst processElement = (n1, n2, container,anchor = null) => {\n\t\tif(n1 == null){\n\t\t\tmountElement(n2, container);\n\t\t}else{\n\t\t\t// 更新\n\t\t\tconsole.log('跟新---')\n\t\t\tpatchElement(n1, n2, container);\n\n\t\t}\n\t}\n\n\t//-------------------- 元素 ---------------------\n\tconst processText = (n1, n2, container) =>{\n\t\tconsole.log('processText--===')\n\t\tif(n1 == null){\n\t\t\thostInsert((n2.el = hostCreateText(n2.children)), container)\n\t\t}\n\t}\n\n\tconst unmount = (n1) => {\n\t\t//组件的话则调用组件生命周期等\n\t\thostRemove(n1.el)\n\t}\n\tconst isSameVNodeType = (n1, n2) => {\n\t\treturn n1.type === n2.type && n1.key === n2.key\n\t}\n\n\tconst patch = (n1, n2, container, anchor = null) => {\n\t\tconst { shapeFlag, type } = n2\n\t\tif(n1 && isSameVNodeType(n1, n2)) {\n\t\t\tanchor = hostNextSibling(n1.el)\n\t\t\tunmount(n1)\n\t\t\tn1 = null\n\t\t}\n\n\t\tswitch (type) {\n\t\t\tcase Text:\n\t\t\t\tprocessText(n1, n2, container)\n\t\t\t\tbreak;\n\t\t\n\t\t\tdefault:\n\t\t\t\tif(shapeFlag & ShapeFlags.ELEMENT){\n\t\t\t\t\tconsole.log('yuanshu',n1, n2, container)\n\t\t\t\t\tprocessElement(n1, n2, container)\n\t\t\n\t\t\t\t}else if(shapeFlag & ShapeFlags.STATEFUL_COMPONENT){\n\t\t\t\t\tprocessComponent(n1, n2, container)\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t}\n\n\tconst render = (vnode, container) => {\n\t\tpatch(null, vnode, container)\n\t}\n\treturn {\n\t\tcreateApp:createAppAPI(render)\n\t}\n}","import { isArray, isObject } from \"@vue/shared\"\nimport { createVNode, isVnode } from \"./vnode\"\n\nexport function h(type, propsOrChildren, children){\n\tconst l = arguments.length // 儿子节点要么是字符串，要么是数组，针对的是createVnode\n\tif(l == 2){ //  类型 + 属性 、 类型 + 孩子\n\t\tif(isObject(propsOrChildren) && isArray(propsOrChildren)){\n\t\t\tif(isVnode(propsOrChildren)){\n\t\t\t\treturn createVNode(type, null, [propsOrChildren])\n\t\t\t}\n\t\t} else {\n\t\t\t// 第二个参数不是对象，那就是孩子\n\t\t\treturn createVNode(type, null, propsOrChildren)\n\t\t}\n\t} else {\n\t\tif(l > 3){\n\t\t\tchildren = Array.prototype.slice.call(arguments,2)\n\t\t}else if(l === 3 && isVnode(children)){\n\t\t\tchildren = [children]\n\t\t}\n\t\treturn createVNode(type, propsOrChildren, children)\n\t}\n}"],"names":[],"mappings":"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"}